# Postman query examples

## Authentication endpoint
(POST) http://localhost:5353/api/auth/register
<pre>
Body:
{
    "fName": "Test",
    "lName": "User",
    "email": "test@user",
    "password": "test123",
    "university": "NTNU",
    "department": "Design",
    "position": "Student"
}
adds a new user (the password stored in the databasse is salted and hashed)
</pre>

(POST) http://localhost:5353/api/auth/login
<pre>
Body:
{
    "email": "test@user",
    "password": "test123"
}
logs in with the given user
this returns an HTTP-only cookie, used for obtaining access tokens, as well as an initial access token which can be used for authentification
(since the user was registered with the register endpoint, their role would be "User", and they would not be authorized for any endpoints requiring the authorization header)
</pre>

(GET) http://localhost:5353/api/auth/refresh
<pre>
Headers: Cookie generated by the login
returns an access token
</pre>

(GET) http://localhost:5353/api/auth/logout
<pre>
Headers: Cookie generated by the login
removes the refresh token cookie
</pre>

## Collection 1 (assessment-cards)
(GET) http://localhost:5353/api/assessment
<pre>
get all assessment cards
</pre>

(GET) http://localhost:5353/api/assessment/1
<pre>
get the assessment card with id 1
</pre>

(POST) http://localhost:5353/api/assessment
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body: (this card would already exist in the database, so it would give a 400 error since card_id has to be unique)
{
    "card_id": 1,
    "card_type": "assessment",
    "card_category": "who is assessed",
    "card_name": "Student",
    "card_description": "A student is assessed individually",
    "card_details": "The student will be assessed either on an independent work or on their contribution in a group assignment.",
    "card_icon": "uploads/icon-assessed.png"
}
</pre>

(PUT) http://localhost:5353/api/assessment/1
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body:
{
    "card_name": "Test",
    "card_description": "This is a test card",
    "card_details": "This would update the details for the assessment card with id 1."
}
</pre>

(DELETE) http://localhost:5353/api/assessment/1
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
delete the assessment card with id 1
</pre>


## Collection 2 (mission-cards)
(GET) http://localhost:5353/api/mission
<pre>
get all mission cards
</pre>

(GET) http://localhost:5353/api/mission/1
<pre>
get the mission card with id 1
</pre>

(POST) http://localhost:5353/api/mission
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body: (this card would already exist in the database, so it would give a 400 error since card_id has to be unique)
{
    "card_id": 1,
    "card_type": "mission",
    "card_name": "Innovation",
    "card_description": "Your mission is To find and support new and innovative ways of assessing students.",
    "card_icon": "uploads/icon-mission-1.png"
}
</pre>

(PUT) http://localhost:5353/api/mission/1
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body:
{
    "card_name": "Test",
    "card_description": "This is a test card",
    "card_details": "This would update the details for the mission card with id 1."
}
</pre>

(DELETE) http://localhost:5353/api/mission/1
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
delete the mission card with id 1
</pre>


## Collection 3 (users)
(GET) http://localhost:5353/api/user
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
get all users
</pre>

(GET) http://localhost:5353/api/user/65f7f7f0e1566a6d6f84915b
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
get the user with the ObjectId "65f7f7f0e1566a6d6f84915b" (this user does not exist in the example database)
</pre>

(GET) http://localhost:5353/api/user/teachers
<pre>
gets the number of teachers in the database
</pre>

(GET) http://localhost:5353/api/user/teachers/test@teacher.com
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
get the ObjectId of the teacher whose email is test@teacher.com (this user would not be in the database)
this endpoint requires your position to be "Teacher"
</pre>

(PUT) http://localhost:5353/api/user/65f7f7f0e1566a6d6f84915b
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body: (this was the _id of the test user, and does not exist anymore)
{
    "role": "Administrator"
}
lets administrators update role and position for users
</pre>

(DELETE) http://localhost:5353/api/user/65f7f7f0e1566a6d6f84915b
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
deletes user with _ID 65f7f7f0e1566a6d6f84915b
</pre>

(PUT) http://localhost:5353/api/user/update/65f7f7f0e1566a6d6f84915b
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body: (this was the _id of the test user, and does not exist anymore)
{
    "fName": "User",
    "lName": "Test"
}
lets users update their own details, not including role and position
</pre>

(PUT) http://localhost:5353/api/user/bookmark/65f7f7f0e1566a6d6f84915b
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body: (this was the _id of the test user, and does not exist anymore)
{
    "bookmark": "663b8a972c945917dd2d51af"
}
adds the scheme with ObjectId "663b8a972c945917dd2d51af" to the user's bookmarked schemes (bookmark is removed if the scheme is already bookmarked)
</pre>


## Collection 4 (schemes)
(GET) http://localhost:5353/api/scheme
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
get all of your schemes
requires position Teacher
</pre>

(GET) http://localhost:5353/api/scheme/public
<pre>
get all public schemes
</pre>

(GET) http://localhost:5353/api/scheme/663b8a972c945917dd2d51af
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
get the scheme with ObjectId "663b8a972c945917dd2d51af"
requires position Teacher
</pre>

(POST) http://localhost:5353/api/scheme
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body:
{
    "mission_cards": [
        "663a34c4dc1906af2e14757a",
        "663a34c4dc1906af2e14757b",
        "663a34c4dc1906af2e14757c"
    ],
    "assessment_cards": [
        "663a34c3dc1906af2e147524",
        "663a34c4dc1906af2e147528",
        "663a34c4dc1906af2e147535",
        "663a34c4dc1906af2e147554",
        "663a34c4dc1906af2e14756a",
        "663a34c4dc1906af2e147570"
    ],
    "creator": "65f7f7f0e1566a6d6f84915b",
    "visibility": "private"
}
create a new scheme
requires position Teacher
</pre>

(PUT) http://localhost:5353/api/scheme/663b8a972c945917dd2d51af
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body:
{
    "visibility": "public"
}
update the scheme with ObjectId "663b8a972c945917dd2d51af" (mission_cards and assessment_cards can also be updated)
requires position Teacher
</pre>

(PUT) http://localhost:5353/api/scheme/rate/663b8a972c945917dd2d51af
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body:
{
    "rating": "4"
}
rates the scheme with ObjectId "663b8a972c945917dd2d51af"
requires position Teacher
</pre>

(DELETE) http://localhost:5353/api/scheme/663b8a972c945917dd2d51af
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
delete the scheme with id "663b8a972c945917dd2d51af"
requires position Teacher
</pre>


## Bulk endpoint
(POST) http://localhost:5353/api/bulk/add-assessment
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body:
{
    "cards": [
        {
            "card-id": 101,
            "card-type": "assessment",
            "card-category": "Who is assessed",
            "card-name": "Student",
            "card-description": "A student is assessed individually",
            "card-details": "The student will be assessed either on an independent work or on their contribution in a group assignment."
        },
        {
            "card-id": 102,
            "card-type": "assessment",
            "card-category": "Who is assessed",
            "card-name": "Student pair",
            "card-description": "Two students work together on an assignment or task.",
            "card-details": "Students can be grouped by own choice, by chance, or by teacher based on their skills and personal characteristics"
        },
        {
            "card-id": 103,
            "card-type": "assessment",
            "card-category": "Who is assessed",
            "card-name": "Student group",
            "card-description": "Three or more students work together on an assignment or project.",
            "card-details": "Students can be grouped by own choice, by chance, or by teacher based on their skills and personal characteristics"
        },
        {
            "card-id": 104,
            "card-type": "assessment",
            "card-category": "Who is assessed",
            "card-name": "Student group from different study programme/Inter-disciplinary student group",
            "card-description": "Student group from different discipline, programme, put together in a group.",
            "card-details": "Three or more student from different disciplines, put together in a group."
        },
        {
            "card-id": 105,
            "card-type": "assessment",
            "card-category": "The assessor",
            "card-name": "Teacher",
            "card-description": "Assess the work of a student or student group",
            "card-details": "Has good knowledge about the course curriculum and learning outcomes."
        }
    ]
}
bulk-adds the given cards to the database
</pre>

(POST) http://localhost:5353/api/bulk/add-mission
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body:
{
    "cards": [
        {
            "card-id": 101,
            "card-type": "Mission",
            "card-name": "Innovation",
            "card-description": "Your mission is to find and support new and innovative ways of assessing students."
        },
        {
            "card-id": 102,
            "card-type": "Mission",
            "card-name": "Time management",
            "card-description": "Your mission is to reduce time used on assessment (not necessarily thinking about costs)."
        },
        {
            "card-id": 103,
            "card-type": "Mission",
            "card-name": "Learning",
            "card-description": "Your mission is to focus on the students' learning outcomes."
        },
        {
            "card-id": 104,
            "card-type": "Mission",
            "card-name": "Student engagement",
            "card-description": "Your mission is to prioritize and support ideas and ways that facilitate student engagement."
        },
        {
            "card-id": 105,
            "card-type": "Mission",
            "card-name": "Authenticity",
            "card-description": "Your mission is to create an authentic and realistic work-life assessment."
        }
    ]
}
bulk-adds the given cards to the database
</pre>

(PUT) http://localhost:5353/api/bulk/edit-assessment
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body: (replace [icon] with whichever new icon you want the cards to have)
{
    "card_ids": [
        1,
        4,
        6,
        9,
        14,
        46,
        67,
        86
    ],
    "new_icon": "[icon]"
}
bulk-edits the specified cards to use the provided icon
</pre>

(PUT) http://localhost:5353/api/bulk/edit-mission
<pre>
Headers: (replace [JWT] with access token generated from login/refresh endpoints)
{
    "authorization": "Bearer [JWT]"
}
Body: (replace [icon] with whichever new icon you want the cards to have)
{
    "card_ids": [
        1,
        3,
        5,
        7
    ],
    "new_icon": "[icon]"
}
bulk-edits the specified cards to use the provided icon
</pre>


## Search endpoint
Only uses the GET method.\
Uses the endpoint "localhost:5353/api/search?params1&param2..."\
Requires the card-type param (determines if the cards are assessment or mission cards)\
Optionally accepts the params:
<pre>
card-category (this does not exist for mission cards)
random (gets 1 card if omitted)
exclude (array of cards to exclude from search)
all (returns every card matching the other criteria)
</pre>

Examples:
<pre>
http://localhost:5353/api/search?card-type=assessment&random=5
    Returns 5 random cards from the assessment collection

http://localhost:5353/api/search?card-type=mission&exclude=[1,3,5,7]
    returns 1 random mission card whose card_id is not equal to 1, 3, 5 or 7

http://localhost:5353/api/search?card-type=mission&random=7&exclude=[2,4,6]
    returns (up to) 7 mission cards, excluding card_id 2, 4 and 6
    (this will only actually return 4 cards, since our database only contains 7 total mission cards)

http://localhost:5353/api/search?card-type=assessment&card-category=the%20assessor&random=5
    returns 5 random assessment cards, whose card category is "the assessor"

http://localhost:5353/api/search?card-type=assessment&card-category=the%20assessor&all
    returns all assessment cards, whose card category is "the assessor"
</pre>
